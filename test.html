<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>terminal.js manual test</title>
  <style>
      .customized-line {
          font-weight: bold;
          background-color: #ff9292;
          color: black;
      }

      #restart-btn {
          display: none;
      }
  </style>
</head>
<body>
<h1>terminal.js manual test suite</h1>
<div id="terminal-1"></div>
<div id="terminal-2-container"></div>
<div id="terminal-3"></div>
<div id="terminal-4"></div>
<button id="restart-btn" onclick="startTestSuite()">Restart test suite</button>
<br/>
<br/>

<script type="module">
  import { Terminal } from "./terminal.js";

  const startTestSuite = async () => {
    let t2Container = document.getElementById("terminal-2-container")
    t2Container.innerHTML = '';
    let restartBtn = document.getElementById('restart-btn');
    restartBtn.style.display = 'none';

    let t1 = new Terminal("terminal-1", { cursorType: 'thin', cursorSpeed: 400 })
    window.t1 = t1;
    t1.setHeight("100px")
      .setWidth('600px')
      .print(`Hello, world! I'm terminal-1`);

    let uneValeur = await t1.sleep2(1000);
    console.log(uneValeur);

    t1.print(`Hello, again! I'm terminal-1`)
      .setPrompt('> ')
      .input('Whats your name?', (input) => {
        t1.print(`Welcome, ${input}`)

        let t2Element = document.createElement('div');
        t2Element.id = "terminal-2"
        let t2 = new Terminal(t2Element)
        t2.setHeight("150px")
          .setWidth('650px')
          .setBackgroundColor('blue')

        t2Container.appendChild(t2.html);

        t2.sleep(200, () => {
          t2.print('Hello again! I\'m terminal-2.')
            .print("I'll ask you a few tasks to ensure the module is still working fine.")
            .pause('PRESS ANY KEY IF THAT\'S OK FOR YOU', () => {
              t2.print(`Great!`)
                .write("I can write...")
                .sleep(800, () => {
                  t2.write('on a single line. ')
                    .sleep(800, () => {
                      t2.write("Isn't it?")
                        .sleep(800, () => {
                          t2.newLine()
                            .newLine()
                            .print("But also break a few lines")
                            .newLine()
                            .newLine()
                            .newLine()
                            .print("Impressive.. uh?")
                            .sleep(500, () => {
                              t3.setVisible(true)
                                .print("Hi, I'm terminal-3.")
                                .printHTML("<strong class='customized-line'>Here's a customized HTML tag.</strong>")
                                .printHTML("<a href='https://github.com/js-shell-emulator/terminal-js'>Github Link</a>")
                                .password('Enter password (a fake one! I\'ll display it):', password => {
                                  t3.print(`Your password is: ${password}`)
                                  t4.setVisible(true).focus();
                                })
                            })
                        })
                    })
                })
            })
        })
      })

    let t3 = new Terminal('terminal-3', {
      height: '150px',
      width: '550px',
      backgroundColor: '#f1f2f5',
      textColor: 'black',
    })

    t3.setVisible(false)


    let t4 = new Terminal('terminal-4')
    t4.setHeight("180px")
      .setWidth('700px')
      .setBackgroundColor('blue')
      .print("Hi, I'm terminal-4")
      .setVisible(false)
      .setPrompt('$ ')
      .expect(['done', 'stop'], 'I expect you to type any command that <strong>IS NOT</strong> "done" or "stop", multiple times. Can you do that?', 'Thank you. You can do that again, or use "stop" to proceed.', (command) => {
        t4.clear()
          .setBackgroundColor("#ffc700")
          .setTextColor("black")
          .print("Thanks!")
          .setPrompt('> ')
          .confirm("Now check the DevTools console, there should be no JavaScript error. Is that ok?", (didConfirm) => {
            if (didConfirm) {
              t4.setBackgroundColor("#00c142")
                .setTextSize("1.5em")
                .clear()
                .print("Amazing! Tests passed. Good bye!")
            } else {
              t4
                .setBackgroundColor('red')
                .setTextColor("white")
                .printHTML("<strong>Damned...would you please open an issue on the <a href='https://github.com/francoisburdy/terminal-js'>GitHub repo</a>?</strong>")
            }

            restartBtn.style.display = 'block';
          })
      })

    t1.focus()
  }

  window.startTestSuite = startTestSuite;
  startTestSuite()
</script>
</body>
</html>
